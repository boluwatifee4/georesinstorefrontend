<!-- Header with Enhanced Design -->
<div class="mb-8">
  <!-- Breadcrumb -->
  <nav class="flex items-center gap-2 text-sm text-gray-600 mb-4">
    <button
      (click)="onBack()"
      class="hover:text-purple-600 transition-colors flex items-center gap-1"
    >
      Products
    </button>
    <ng-icon name="lucideArrowLeft" class="rotate-180 text-xs text-gray-400"></ng-icon>
    <span class="text-gray-900 font-medium">{{ product()?.title || 'Product Details' }}</span>
  </nav>

  <!-- Header Card -->
  <div class="bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-3 sm:p-6 border border-purple-100">
    <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4">
      <div class="flex items-start gap-3 sm:gap-4">
        <!-- Product Icon -->
        <div class="w-12 h-12 sm:w-16 sm:h-16 bg-white rounded-xl shadow-sm flex items-center justify-center">
          <ng-icon name="lucidePackage" class="text-xl sm:text-2xl text-purple-600"></ng-icon>
        </div>

        <!-- Product Info -->
        <div>
          <h1 class="text-lg sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-2">
            {{ product()?.title || 'Loading...' }}
          </h1>
          <div class="flex flex-wrap items-center gap-2 sm:gap-4 text-sm">
            <span class="text-gray-600 text-xs sm:text-sm">ID: {{ product()?.id }}</span>
            <span *ngIf="product()" class="inline-flex px-2 sm:px-3 py-1 rounded-full text-xs font-semibold {{ getStatusBadgeClass(product()!) }}">
              {{ getStatusText(product()!) }}
            </span>
          </div>
          <p class="text-purple-700 mt-2 font-medium text-sm hidden sm:block">Manage all aspects of your product</p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-2 sm:gap-3">
        <button
          (click)="onEditProduct()"
          class="inline-flex items-center gap-1 sm:gap-2 bg-white text-purple-700 px-3 py-2 sm:px-6 sm:py-3 rounded-xl font-medium md:hover:bg-purple-50 transition-all duration-200 shadow-sm border border-purple-200 md:hover:shadow-md text-sm active:bg-purple-100 active:scale-95"
        >
          <ng-icon name="lucidePencil" class="text-base sm:text-lg"></ng-icon>
          <span class="hidden sm:inline">Edit Product</span>
          <span class="sm:hidden">Edit</span>
        </button>
        <button
          (click)="onDeleteProduct()"
          class="inline-flex items-center gap-1 sm:gap-2 bg-white text-red-600 px-3 py-2 sm:px-6 sm:py-3 rounded-xl font-medium md:hover:bg-red-50 transition-all duration-200 shadow-sm border border-red-200 md:hover:shadow-md text-sm active:bg-red-100 active:scale-95"
        >
          <ng-icon name="lucideTrash2" class="text-base sm:text-lg"></ng-icon>
          <span class="hidden sm:inline">Delete</span>
          <span class="sm:hidden">Del</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="loading()" class="flex items-center justify-center py-20">
  <div class="text-center">
    <div class="w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
    <p class="text-gray-600 text-lg">Loading product details...</p>
  </div>
</div>

<!-- Error State -->
<div *ngIf="error() && !loading()" class="bg-red-50 border-2 border-red-200 rounded-2xl p-8 mb-8">
  <div class="flex items-center justify-center">
    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4">
      <ng-icon name="lucideTriangle" class="text-red-600 text-xl"></ng-icon>
    </div>
    <div>
      <h3 class="text-lg font-semibold text-red-900 mb-1">Error Loading Product</h3>
      <p class="text-red-700">{{ error() }}</p>
    </div>
  </div>
</div>

<!-- Main Content - Only show when not loading and no error -->
<div *ngIf="!loading() && !error() && product()" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <!-- Primary Product Information -->
  <div class="lg:col-span-2 space-y-8">
    <!-- Product Information Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
      <div class="px-4 sm:px-8 py-4 sm:py-6 bg-gradient-to-r from-gray-50 to-gray-50/50 border-b border-gray-100">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-xl flex items-center justify-center">
            <ng-icon name="lucideInfo" class="text-blue-600 text-base sm:text-lg"></ng-icon>
          </div>
          <h2 class="text-lg sm:text-xl font-bold text-gray-900">Product Information</h2>
        </div>
      </div>

      <div class="p-4 sm:p-8">
        <!-- Product Details Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
          <!-- Basic Information -->
          <div class="space-y-3 sm:space-y-4">
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Title</label>
              <p class="text-gray-900 bg-gray-50 px-3 sm:px-4 py-2 sm:py-3 rounded-xl text-sm sm:text-base">{{ product()!.title }}</p>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Slug</label>
              <p class="text-gray-900 bg-gray-50 px-3 sm:px-4 py-2 sm:py-3 rounded-xl font-mono text-xs sm:text-sm break-all">{{ product()!.slug }}</p>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Status</label>
              <span class="inline-flex px-3 py-1.5 rounded-full text-sm font-medium {{ getStatusBadgeClass(product()!) }}">
                {{ getStatusText(product()!) }}
              </span>
            </div>
          </div>

          <!-- Pricing Information -->
          <div class="space-y-3 sm:space-y-4">
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Base Price</label>
              <p class="text-gray-900 bg-gray-50 px-3 sm:px-4 py-2 sm:py-3 rounded-xl font-semibold text-sm sm:text-base">
                â‚¦{{ product()!.basePrice?.toFixed(2) || '0.00' }}
              </p>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Base Inventory</label>
              <p class="text-gray-900 bg-gray-50 px-3 sm:px-4 py-2 sm:py-3 rounded-xl text-sm sm:text-base">{{ product()!.baseInventory }} units</p>
            </div>
          </div>
        </div>

        <!-- Description -->
        <div class="mt-4 sm:mt-6">
          <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
          <div class="bg-gray-50 px-3 sm:px-4 py-3 sm:py-4 rounded-xl">
            <p class="text-gray-900 whitespace-pre-wrap leading-relaxed text-sm sm:text-base">{{ product()!.description || 'No description available' }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Media Management Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
      <div class="px-4 sm:px-8 py-4 sm:py-6 bg-gradient-to-r from-green-50 to-emerald-50 border-b border-gray-100">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 sm:w-10 sm:h-10 bg-green-100 rounded-xl flex items-center justify-center">
            <ng-icon name="lucideImage" class="text-green-600 text-base sm:text-lg"></ng-icon>
          </div>
          <h2 class="text-lg sm:text-xl font-bold text-gray-900">Media Gallery</h2>
          <span class="ml-auto text-xs sm:text-sm text-gray-500">{{ product()?.media?.length || 0 }} items</span>
        </div>
      </div>

      <div class="p-4 sm:p-8">
        <!-- Add Media Form -->
        <div class="mb-6 sm:mb-8 p-4 sm:p-6 bg-gradient-to-r from-green-50 to-green-50/50 rounded-2xl border border-green-100">
          <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2">
            <ng-icon name="lucidePlus" class="text-green-600"></ng-icon>
            Add New Media
          </h3>
          <form [formGroup]="mediaForm" (ngSubmit)="onAddMedia()">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 mb-4">
              <div>
                <label for="mediaUrl" class="block text-sm font-semibold text-gray-700 mb-2">
                  Image URL *
                </label>
                <input
                  id="mediaUrl"
                  type="url"
                  formControlName="url"
                  placeholder="https://example.com/image.jpg"
                  (change)="onImageUrlChange($event)"
                  class="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 bg-white text-sm"
                  [class.border-red-300]="getMediaFieldError('url')"
                  [class.focus:ring-red-500]="getMediaFieldError('url')"
                  [class.focus:border-red-500]="getMediaFieldError('url')"
                >
                <div *ngIf="getMediaFieldError('url')" class="mt-2 text-sm text-red-600 flex items-center gap-1">
                  <ng-icon name="lucideTriangleAlert" class="text-xs"></ng-icon>
                  {{ getMediaFieldError('url') }}
                </div>
                <div class="mt-2 text-xs text-gray-500">
                  <div class="flex items-start gap-1">
                    <ng-icon name="lucideInfo" class="text-xs mt-0.5 text-blue-500"></ng-icon>
                    <div>
                      <strong>Google Drive:</strong> Paste the sharing link - we'll convert it automatically.
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <label for="mediaAlt" class="block text-sm font-semibold text-gray-700 mb-2">
                  Alt Text
                </label>
                <input
                  id="mediaAlt"
                  type="text"
                  formControlName="alt"
                  placeholder="Describe this image"
                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 bg-white"
                >
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
              <div>
                <label for="mediaPosition" class="block text-sm font-semibold text-gray-700 mb-2">
                  Position
                </label>
                <input
                  id="mediaPosition"
                  type="number"
                  formControlName="position"
                  min="0"
                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 bg-white"
                >
              </div>

              <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                  Primary Image
                </label>
                <div class="flex items-center gap-3 pt-2">
                  <label class="relative inline-flex items-center cursor-pointer">
                    <input
                      type="checkbox"
                      formControlName="isPrimary"
                      class="sr-only peer"
                    >
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                    <span class="ml-3 text-sm text-gray-700">Set as primary image</span>
                  </label>
                </div>
              </div>
            </div>

            <button
              type="submit"
              [disabled]="mediaForm.invalid || loading()"
              class="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <ng-icon name="lucidePlus" class="text-lg"></ng-icon>
              <span *ngIf="!loading()">Add Media</span>
              <span *ngIf="loading()">Adding...</span>
            </button>
          </form>
        </div>
        <!-- Media Gallery -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div
            *ngFor="let media of product()?.media"
            class="group relative bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm md:hover:shadow-md transition-all duration-200"
          >
            <!-- Image -->
            <div class="aspect-square bg-gray-100">
              <img
                [src]="media.url"
                [alt]="media.alt || 'Product image'"
                class="w-full h-full object-cover"
                loading="lazy"
              >
            </div>

            <!-- Media Info Overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-200">
              <div class="absolute bottom-0 left-0 right-0 p-3 sm:p-4">
                <div class="flex items-center justify-between text-white">
                  <div class="text-xs sm:text-sm">
                    <p class="font-medium">Position: {{ media.position }}</p>
                    <p *ngIf="media.isPrimary" class="text-xs text-green-300 flex items-center gap-1">
                      <ng-icon name="lucideStar" class="text-xs"></ng-icon>
                      Primary Image
                    </p>
                  </div>
                  <button
                    (click)="onRemoveMedia(media)"
                    class="w-8 h-8 bg-red-500 md:hover:bg-red-600 active:bg-red-600 active:scale-95 rounded-full flex items-center justify-center transition-all duration-200"
                  >
                    <ng-icon name="lucideTrash2" class="text-sm"></ng-icon>
                  </button>
                </div>
              </div>
            </div>

            <!-- Primary Badge -->
            <div *ngIf="media.isPrimary" class="absolute top-3 left-3">
              <span class="inline-flex items-center gap-1 bg-green-500 text-white text-xs font-semibold px-2 py-1 rounded-full">
                <ng-icon name="lucideStar" class="text-xs"></ng-icon>
                Primary
              </span>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!product()?.media?.length" class="text-center py-12">
          <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <ng-icon name="lucideImage" class="text-gray-400 text-2xl"></ng-icon>
          </div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">No media yet</h3>
          <p class="text-gray-600 mb-6">Add some images to showcase your product</p>
        </div>
      </div>
    </div>

  <!-- Sidebar -->
  <div class="lg:col-span-1 space-y-6 lg:space-y-8">
    <!-- Quick Stats Card -->
    <div class="bg-gradient-to-r from-purple-50 to-blue-50 rounded-2xl p-4 sm:p-6 border border-purple-100">
      <h3 class="text-base sm:text-lg font-bold text-gray-900 mb-4">Quick Stats</h3>
      <div class="grid grid-cols-1 gap-4">
        <div class="bg-white/80 rounded-xl p-4 backdrop-blur-sm">
          <div class="text-2xl font-bold text-purple-600">{{ product()?.media?.length || 0 }}</div>
          <div class="text-sm text-gray-600">Media Files</div>
        </div>
        <div class="bg-white/80 rounded-xl p-4 backdrop-blur-sm">
          <div class="text-2xl font-bold text-blue-600">{{ product()?.categories?.length || 0 }}</div>
          <div class="text-sm text-gray-600">Categories</div>
        </div>
        <div class="bg-white/80 rounded-xl p-4 backdrop-blur-sm">
          <div class="text-2xl font-bold text-green-600">{{ product()?.optionGroups?.length || 0 }}</div>
          <div class="text-sm text-gray-600">Option Groups</div>
        </div>
      </div>
    </div>

    <!-- Category Management Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
      <div class="px-4 sm:px-6 py-4 sm:py-5 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-100">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 sm:w-9 sm:h-9 bg-blue-100 rounded-lg flex items-center justify-center">
            <ng-icon name="lucideTag" class="text-blue-600"></ng-icon>
          </div>
          <h2 class="text-base sm:text-lg font-bold text-gray-900">Categories</h2>
          <span class="ml-auto text-sm text-gray-500">{{ product()?.categories?.length || 0 }}</span>
        </div>
      </div>

      <div class="p-4 sm:p-6">
        <!-- Add Category Form -->
        <div class="mb-6 p-4 bg-blue-50 rounded-xl">
          <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
            <ng-icon name="lucidePlus" class="text-blue-600"></ng-icon>
            Assign Category
          </h3>
          <form [formGroup]="categoryForm" (ngSubmit)="onAssignCategory()">
            <div class="mb-4">
              <select
                formControlName="categoryId"
                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 bg-white"
                [class.border-red-300]="getCategoryFieldError('categoryId')"
                [class.focus:ring-red-500]="getCategoryFieldError('categoryId')"
                [class.focus:border-red-500]="getCategoryFieldError('categoryId')"
              >
                <option value="">Select a category...</option>
                <option *ngFor="let category of categories()" [value]="category.id">
                  {{ category.name }}
                </option>
              </select>
              <div *ngIf="getCategoryFieldError('categoryId')" class="mt-2 text-sm text-red-600 flex items-center gap-1">
                <ng-icon name="lucideTriangle" class="text-xs"></ng-icon>
                {{ getCategoryFieldError('categoryId') }}
              </div>
            </div>

            <button
              type="submit"
              [disabled]="categoryForm.invalid || loading()"
              class="w-full inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <ng-icon name="lucidePlus" class="text-lg"></ng-icon>
              <span *ngIf="!loading()">Assign Category</span>
              <span *ngIf="loading()">Assigning...</span>
            </button>
          </form>
        </div>
        <!-- Current Categories -->
        <div *ngIf="product()?.categories?.length">
          <h4 class="text-sm font-semibold text-gray-700 mb-3">Current Categories</h4>
          <div class="flex flex-wrap gap-2">
            <div
              *ngFor="let category of product()?.categories"
              class="group inline-flex items-center gap-2 bg-blue-100 md:hover:bg-blue-200 active:bg-blue-200 active:scale-95 text-blue-800 px-3 py-2 rounded-xl text-sm font-medium transition-all duration-200"
            >
              <ng-icon name="lucideTag" class="text-xs"></ng-icon>
              <span>{{ category.name }}</span>
              <button
                (click)="onRemoveCategory(category)"
                class="opacity-70 md:opacity-0 md:group-hover:opacity-100 md:hover:bg-blue-300 active:bg-blue-300 rounded-full p-1 transition-all duration-200 min-w-[24px] min-h-[24px] flex items-center justify-center"
                title="Remove category"
              >
                <ng-icon name="lucideX" class="text-xs"></ng-icon>
              </button>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!product()?.categories?.length" class="text-center py-6">
          <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <ng-icon name="lucideTag" class="text-blue-500"></ng-icon>
          </div>
          <p class="text-gray-600 text-sm">No categories assigned</p>
        </div>
      </div>
    </div>

    <!-- Option Groups Management Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
      <div class="px-4 sm:px-6 py-4 sm:py-5 bg-gradient-to-r from-green-50 to-teal-50 border-b border-gray-100">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 sm:w-9 sm:h-9 bg-green-100 rounded-lg flex items-center justify-center">
            <ng-icon name="lucideSettings" class="text-green-600"></ng-icon>
          </div>
          <h2 class="text-base sm:text-lg font-bold text-gray-900">Option Groups</h2>
          <span class="ml-auto text-sm text-gray-500">{{ product()?.optionGroups?.length || 0 }}</span>
        </div>
      </div>

      <div class="p-4 sm:p-6">
        <!-- Attach Option Group Form -->
        <div class="mb-6 p-4 bg-green-50 rounded-xl">
          <h3 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2">
            <ng-icon name="lucidePlus" class="text-green-600"></ng-icon>
            Attach Option Group
          </h3>
          <form [formGroup]="optionGroupForm" (ngSubmit)="onAttachOptionGroup()">
            <div class="mb-4">
              <select
                formControlName="groupId"
                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 bg-white"
                [class.border-red-300]="getOptionGroupFieldError('groupId')"
                [class.focus:ring-red-500]="getOptionGroupFieldError('groupId')"
                [class.focus:border-red-500]="getOptionGroupFieldError('groupId')"
              >
                <option value="">Select an option group...</option>
                <option *ngFor="let group of optionGroups()" [value]="group.id">
                  {{ group.name }}
                </option>
              </select>
              <div *ngIf="getOptionGroupFieldError('groupId')" class="mt-2 text-sm text-red-600 flex items-center gap-1">
                <ng-icon name="lucideTriangle" class="text-xs"></ng-icon>
                {{ getOptionGroupFieldError('groupId') }}
              </div>
            </div>

            <button
              type="submit"
              [disabled]="optionGroupForm.invalid || attachingOptionGroup()"
              class="w-full inline-flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-xl font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <ng-icon name="lucidePlus" class="text-lg"></ng-icon>
              <span *ngIf="!attachingOptionGroup()">Attach Option Group</span>
              <span *ngIf="attachingOptionGroup()">Attaching...</span>
            </button>
          </form>
        </div>

        <!-- Current Option Groups -->
        <div *ngIf="product()?.optionGroups?.length">
          <h4 class="text-sm font-semibold text-gray-700 mb-3">Attached Option Groups</h4>
          <div class="space-y-3">
            <div
              *ngFor="let group of product()?.optionGroups"
              class="group bg-gray-50 md:hover:bg-gray-100 active:bg-gray-100 rounded-xl p-4 border border-gray-200 transition-all duration-200"
            >
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                    <ng-icon name="lucideSettings" class="text-green-600 text-sm"></ng-icon>
                  </div>
                  <div>
                    <h5 class="font-medium text-gray-900 text-sm sm:text-base">{{ group.name }}</h5>
                    <p class="text-xs sm:text-sm text-gray-600">{{ group.options?.length || 0 }} options available</p>
                  </div>
                </div>
                <button
                  (click)="onDetachOptionGroup(group)"
                  [disabled]="detachingOptionGroup() === group.id"
                  class="opacity-70 md:opacity-0 md:group-hover:opacity-100 w-8 h-8 bg-red-100 md:hover:bg-red-200 active:bg-red-200 active:scale-95 text-red-600 rounded-lg flex items-center justify-center transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                  title="Detach option group"
                >
                  <div *ngIf="detachingOptionGroup() === group.id" class="w-3 h-3 border border-red-400 border-t-transparent rounded-full animate-spin"></div>
                  <ng-icon *ngIf="detachingOptionGroup() !== group.id" name="lucideX" class="text-sm"></ng-icon>
                </button>
              </div>

              <!-- Options Preview -->
              <div *ngIf="group.options?.length" class="mt-3 flex flex-wrap gap-1">
                <span
                  *ngFor="let option of group.options | slice:0:3"
                  class="inline-flex items-center px-2 py-1 rounded-md bg-white text-xs text-gray-700 border border-gray-200"
                >
                  {{ option.value }}
                </span>
                <span *ngIf="(group.options?.length || 0) > 3" class="inline-flex items-center px-2 py-1 rounded-md bg-gray-200 text-xs text-gray-600">
                  +{{ (group.options?.length || 0) - 3 }} more
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!product()?.optionGroups?.length" class="text-center py-6">
          <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <ng-icon name="lucideSettings" class="text-green-500"></ng-icon>
          </div>
          <p class="text-gray-600 text-sm">No option groups attached</p>
        </div>
      </div>
    </div>
  </div>
</div>
